<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Congress Members - Legislative Profiles</title>
    <meta name="description" content="Browse Congress members with legislative activity and financial disclosure data">
    <link rel="stylesheet" href="style.css">
    <style>
        .filters {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--bg-secondary, #f5f5f5);
            border-radius: 8px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .filter-group label {
            font-size: 0.75rem;
            color: #666;
            text-transform: uppercase;
            font-weight: 500;
        }

        .filter-group select {
            padding: 0.5rem 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-width: 120px;
        }

        .members-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }

        .member-card {
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 1rem;
            background: white;
            transition: box-shadow 0.2s;
        }

        .member-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .member-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }

        .member-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .member-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin: 0;
        }

        .member-meta {
            font-size: 0.8rem;
            color: #666;
        }

        .party-badge {
            display: inline-block;
            padding: 0.15rem 0.4rem;
            font-size: 0.7rem;
            border-radius: 3px;
            font-weight: 600;
        }

        .party-D {
            background: #bbdefb;
            color: #1565c0;
        }

        .party-R {
            background: #ffcdd2;
            color: #c62828;
        }

        .party-I {
            background: #e1bee7;
            color: #7b1fa2;
        }

        .member-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid #eee;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
        }

        .stat-label {
            font-size: 0.65rem;
            color: #999;
            text-transform: uppercase;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #666;
        }

        .view-profile {
            display: block;
            text-align: center;
            margin-top: 0.75rem;
            padding: 0.5rem;
            background: #f5f5f5;
            border-radius: 4px;
            color: #0066cc;
            text-decoration: none;
            font-size: 0.85rem;
        }

        .view-profile:hover {
            background: #e8e8e8;
        }

        .profile-avatar-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
    </style>
</head>

<body>
    <div class="app-container">
        <div id="nav-container"></div>

        <main class="main-content">
            <div class="container">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">ðŸ‘¥ Congress Members</h2>
                        <p class="card-description">Browse legislative profiles with FD correlation data</p>
                    </div>
                    <div class="card-content">
                        <!-- Filters -->
                        <div class="filters">
                            <div class="filter-group">
                                <label>Congress</label>
                                <select id="filter-congress">
                                    <option value="true" selected>119th (Current)</option>
                                    <option value="">All (incl. former)</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Chamber</label>
                                <select id="filter-chamber">
                                    <option value="">All</option>
                                    <option value="house">House</option>
                                    <option value="senate">Senate</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Party</label>
                                <select id="filter-party">
                                    <option value="">All</option>
                                    <option value="D">Democrat</option>
                                    <option value="R">Republican</option>
                                    <option value="I">Independent</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>State</label>
                                <select id="filter-state">
                                    <option value="">All States</option>
                                </select>
                            </div>
                            <button id="apply-filters" class="btn">Apply Filters</button>
                        </div>

                        <!-- Members Grid -->
                        <div id="members-container" class="members-grid">
                            <div class="loading">Loading members...</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="footer">
            <div class="container">
                <div class="footer-content">
                    <p>Data from <a href="https://api.congress.gov" target="_blank">Congress.gov</a> and House Financial
                        Disclosures.
                        <a href="https://github.com/Jakeintech/congress-disclosures-standardized" target="_blank">View
                            on GitHub</a>
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <script src="nav.js"></script>
    <script>
        const MEMBERS_API_BASE = window.CONFIG?.API_BASE || 'https://yvpi88rhwl.execute-api.us-east-1.amazonaws.com';
        const STATES = ['AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DE', 'FL', 'GA', 'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD', 'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ', 'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC', 'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY', 'DC', 'PR', 'GU', 'VI', 'AS'];

        // Populate states dropdown
        document.addEventListener('DOMContentLoaded', () => {
            const stateSelect = document.getElementById('filter-state');
            STATES.forEach(state => {
                stateSelect.innerHTML += `<option value="${state}">${state}</option>`;
            });
            loadMembers();
        });

        async function loadMembers() {
            const container = document.getElementById('members-container');
            container.innerHTML = '<div class="loading">Loading members...</div>';

            const isCurrent = document.getElementById('filter-congress').value;
            const chamber = document.getElementById('filter-chamber').value;
            const party = document.getElementById('filter-party').value;
            const state = document.getElementById('filter-state').value;

            const params = new URLSearchParams({ limit: 100 });
            if (isCurrent) params.append('is_current', isCurrent);
            if (chamber) params.append('chamber', chamber);
            if (party) params.append('party', party);
            if (state) params.append('state', state);

            try {
                const response = await fetch(`${MEMBERS_API_BASE}/v1/congress/members?${params}`);
                const data = await response.json();

                if (!data.data || data.data.length === 0) {
                    container.innerHTML = '<div class="loading">No members found.</div>';
                    return;
                }

                container.innerHTML = data.data.map(member => `
                    <div class="member-card">
                        <div class="member-header">
                            <div class="member-avatar">
                                ${member.image_url
                        ? `<img src="${member.image_url}" alt="${member.first_name} ${member.last_name}" class="profile-avatar-img" onerror="this.outerHTML='${getInitials(member)}'">`
                        : getInitials(member)
                    }
                            </div>
                            <div>
                                <h3 class="member-name">${member.first_name || ''} ${member.last_name || ''}</h3>
                                <div class="member-meta">
                                    <span class="party-badge party-${member.party || 'I'}">${member.party || 'I'}</span>
                                    ${member.state || ''} â€¢ ${capitalize(member.chamber || '')}
                                </div>
                            </div>
                        </div>
                        <div class="member-stats">
                            <div class="stat-item">
                                <div class="stat-value">${member.sponsored_legislation_count || member.bills_sponsored || 0}</div>
                                <div class="stat-label">Bills</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${member.cosponsored_legislation_count || member.bills_cosponsored || 0}</div>
                                <div class="stat-label">Cosponsored</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${member.fd_transaction_count || 0}</div>
                                <div class="stat-label">FD Trades</div>
                            </div>
                        </div>
                        <a href="member-profile.html?id=${member.bioguide_id}" class="view-profile">View Legislative Profile â†’</a>
                    </div>
                `).join('');
            } catch (error) {
                container.innerHTML = `<div class="loading">Error loading members: ${error.message}</div>`;
            }
        }

        function getInitials(member) {
            const first = (member.first_name || '')[0] || '';
            const last = (member.last_name || '')[0] || '';
            return (first + last).toUpperCase() || '?';
        }

        function capitalize(str) {
            if (!str) return '';
            return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
        }

        document.getElementById('apply-filters').addEventListener('click', loadMembers);
    </script>
</body>

</html>