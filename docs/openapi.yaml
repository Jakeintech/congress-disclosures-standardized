openapi: 3.0.3
info:
  title: Congressional Trading Data API
  version: 1.0.0
  description: |
    Public REST API for querying U.S. House of Representatives financial disclosure data.
    
    This API provides access to congressional trading data, member portfolios, and filing information
    from the standardized Gold Layer. All data is sourced from official House disclosures.
    
    **Features:**
    - No authentication required (public access)
    - Rate limited to 1000 requests/hour per IP
    - Fast DuckDB-powered Parquet queries
    - Comprehensive filtering and pagination
    
    **Data Sources:**
    - Official House Financial Disclosures
    - Updated daily from https://disclosures-clerk.house.gov/
  contact:
    name: Congress Disclosures Standardized
    url: https://github.com/Jakeintech/congress-disclosures-standardized
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://yvpi88rhwl.execute-api.us-east-1.amazonaws.com
    description: Production API Gateway

tags:
  - name: Members
    description: Member profiles and information
  - name: Trading
    description: Stock trading transactions
  - name: Analytics
    description: Aggregated statistics and insights
  - name: Search
    description: Search and discovery
  - name: Filings
    description: Financial disclosure filings
  - name: Congress
    description: Congress.gov legislative data (bills, votes, members)
  - name: System
    description: System status and metrics

paths:
  # ============================================================================
  # System Endpoints
  # ============================================================================

  /v1/costs:
    get:
      tags: [System]
      summary: Get AWS costs
      description: Get daily and total AWS costs for the last 30 days
      responses:
        '200':
          description: Cost data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CostResponse'

  # ============================================================================
  # Member Endpoints
  # ============================================================================
  
  /v1/members:
    get:
      tags: [Members]
      summary: List all members
      description: Get paginated list of House members with optional filtering
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: state
          in: query
          description: Filter by state (e.g., CA, NY)
          schema:
            type: string
            pattern: '^[A-Z]{2}$'
        - name: district
          in: query
          description: Filter by district number
          schema:
            type: string
        - name: party
          in: query
          description: Filter by political party
          schema:
            type: string
            enum: [D, R, I]
      responses:
        '200':
          description: Successful response with paginated members
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MemberListResponse'
              example:
                success: true
                data:
                  - bioguide_id: P000197
                    first_name: Nancy
                    last_name: Pelosi
                    party: D
                    state: CA
                    district: "11"
                pagination:
                  total: 435
                  count: 50
                  limit: 50
                  offset: 0
                  has_next: true
                  next: /v1/members?limit=50&offset=50

  /v1/members/{bioguide_id}:
    get:
      tags: [Members]
      summary: Get member profile
      description: Get detailed profile for a specific member including trading stats
      parameters:
        - name: bioguide_id
          in: path
          required: true
          description: Member's bioguide ID
          schema:
            type: string
          example: P000197
      responses:
        '200':
          description: Member profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MemberProfile'
        '404':
          $ref: '#/components/responses/NotFound'

  /v1/members/{bioguide_id}/trades:
    get:
      tags: [Members]
      summary: Get member's trades
      description: Get all trading transactions for a specific member
      parameters:
        - name: bioguide_id
          in: path
          required: true
          schema:
            type: string
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/StartDate'
        - $ref: '#/components/parameters/EndDate'
        - name: ticker
          in: query
          schema:
            type: string
        - name: transaction_type
          in: query
          schema:
            type: string
            enum: [Purchase, Sale, Exchange]
      responses:
        '200':
          description: Paginated list of trades
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TradeListResponse'

  /v1/members/{bioguide_id}/portfolio:
    get:
      tags: [Members]
      summary: Get member's portfolio
      description: Get current asset holdings for a member
      parameters:
        - name: bioguide_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Portfolio holdings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PortfolioResponse'

  # ============================================================================
  # Trading Endpoints
  # ============================================================================

  /v1/trades:
    get:
      tags: [Trading]
      summary: List all trades
      description: Get all trading transactions with comprehensive filtering
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: ticker
          in: query
          description: Filter by stock ticker
          schema:
            type: string
        - name: bioguide_id
          in: query
          description: Filter by member
          schema:
            type: string
        - name: transaction_type
          in: query
          schema:
            type: string
            enum: [Purchase, Sale, Exchange]
        - $ref: '#/components/parameters/StartDate'
        - $ref: '#/components/parameters/EndDate'
        - name: min_amount
          in: query
          description: Minimum transaction amount
          schema:
            type: number
        - name: max_amount
          in: query
          description: Maximum transaction amount
          schema:
            type: number
      responses:
        '200':
          description: Paginated trades
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TradeListResponse'
              example:
                success: true
                data:
                  - transaction_id: "12345"
                    bioguide_id: P000197
                    ticker: AAPL
                    transaction_type: Purchase
                    transaction_date: "2025-01-15"
                    amount: 50000
                pagination:
                  total: 1500
                  count: 50
                  limit: 50
                  offset: 0

  /v1/stocks/{ticker}:
    get:
      tags: [Trading]
      summary: Get stock summary
      description: Get trading statistics and recent activity for a specific stock
      parameters:
        - name: ticker
          in: path
          required: true
          description: Stock ticker symbol
          schema:
            type: string
          example: AAPL
      responses:
        '200':
          description: Stock summary
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StockSummary'
        '404':
          $ref: '#/components/responses/NotFound'

  /v1/stocks/{ticker}/activity:
    get:
      tags: [Trading]
      summary: Get stock trading activity
      description: Get all congressional trades for a specific stock
      parameters:
        - name: ticker
          in: path
          required: true
          schema:
            type: string
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/StartDate'
        - $ref: '#/components/parameters/EndDate'
      responses:
        '200':
          description: Stock trading activity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TradeListResponse'

  /v1/stocks:
    get:
      tags: [Trading]
      summary: List all stocks
      description: Get list of all stocks with congressional trading activity
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: min_trades
          in: query
          description: Minimum number of trades
          schema:
            type: integer
      responses:
        '200':
          description: List of stocks
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StockListResponse'

  # ============================================================================
  # Analytics Endpoints
  # ============================================================================

  /v1/analytics/summary:
    get:
      tags: [Analytics]
      summary: Get platform summary
      description: Get high-level statistics for the entire platform
      responses:
        '200':
          description: Platform summary
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SummaryResponse'
              example:
                success: true
                data:
                  members:
                    total: 435
                  trades:
                    total: 15000
                    unique_stocks: 2500
                    latest_transaction: "2025-12-01"
                  filings:
                    total: 5000
                    latest_filing: "2025-12-01"
                    coverage_years: [2020, 2021, 2022, 2023, 2024, 2025]

  /v1/analytics/top-traders:
    get:
      tags: [Analytics]
      summary: Get top traders
      description: Get members with highest trading volume
      parameters:
        - name: limit
          in: query
          description: Number of results (max 100)
          schema:
            type: integer
            default: 20
            maximum: 100
        - name: year
          in: query
          description: Filter by year
          schema:
            type: integer
      responses:
        '200':
          description: Top traders
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TopTradersResponse'

  /v1/analytics/trending-stocks:
    get:
      tags: [Analytics]
      summary: Get trending stocks
      description: Get stocks with most recent congressional trading activity
      parameters:
        - name: days
          in: query
          description: Time window in days
          schema:
            type: integer
            default: 30
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
            maximum: 100
      responses:
        '200':
          description: Trending stocks
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TrendingStocksResponse'

  /v1/analytics/sector-activity:
    get:
      tags: [Analytics]
      summary: Get sector activity
      description: Get trading activity breakdown by market sector
      responses:
        '200':
          description: Sector statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SectorActivityResponse'

  /v1/analytics/compliance:
    get:
      tags: [Analytics]
      summary: Get compliance metrics
      description: Get filing compliance statistics for members
      responses:
        '200':
          description: Compliance metrics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComplianceResponse'

  /v1/analytics/trading-timeline:
    get:
      tags: [Analytics]
      summary: Get trading timeline
      description: Get daily trading volume over time
      parameters:
        - $ref: '#/components/parameters/StartDate'
        - $ref: '#/components/parameters/EndDate'
      responses:
        '200':
          description: Trading timeline
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TimelineResponse'

  # ============================================================================
  # Search & Filing Endpoints
  # ============================================================================

  /v1/search:
    get:
      tags: [Search]
      summary: Search across all data
      description: Unified search across members, stocks, and trades
      parameters:
        - name: q
          in: query
          required: true
          description: Search query (minimum 2 characters)
          schema:
            type: string
            minLength: 2
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /v1/filings:
    get:
      tags: [Filings]
      summary: List filings
      description: Get list of financial disclosure filings
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: bioguide_id
          in: query
          schema:
            type: string
        - name: filing_type
          in: query
          schema:
            type: string
            enum: [A, N, T, P]
        - $ref: '#/components/parameters/StartDate'
        - $ref: '#/components/parameters/EndDate'
      responses:
        '200':
          description: Paginated filings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FilingListResponse'

  /v1/filings/{doc_id}:
    get:
      tags: [Filings]
      summary: Get filing details
      description: Get complete filing information including extracted data
      parameters:
        - name: doc_id
          in: path
          required: true
          description: Document ID
          schema:
            type: string
      responses:
        '200':
          description: Filing details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FilingDetail'
        '404':
          $ref: '#/components/responses/NotFound'

  /v1/filings/{doc_id}/transactions:
    get:
      tags: [Filings]
      summary: Get filing transactions
      description: Get all transactions listed in a specific filing (Type P)
      parameters:
        - name: doc_id
          in: path
          required: true
          description: Document ID
          schema:
            type: string
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: ticker
          in: query
          schema:
            type: string
        - name: asset_type
          in: query
          schema:
            type: string
        - name: transaction_type
          in: query
          schema:
            type: string
            enum: [Purchase, Sale, Exchange]
      responses:
        '200':
          description: List of transactions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FilingTransactionListResponse'

  /v1/filings/{doc_id}/assets:
    get:
      tags: [Filings]
      summary: Get filing assets
      description: Get all asset holdings listed in a specific filing (Type A/B/C Schedule A)
      parameters:
        - name: doc_id
          in: path
          required: true
          description: Document ID
          schema:
            type: string
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: asset_type
          in: query
          schema:
            type: string
        - name: owner
          in: query
          description: Filter by owner code (Self, SP, DC, JT)
          schema:
            type: string
      responses:
        '200':
          description: List of asset holdings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AssetHoldingListResponse'

  /v1/filings/{doc_id}/positions:
    get:
      tags: [Filings]
      summary: Get filing positions
      description: Get all positions listed in a specific filing (Type A/B/C Schedule E)
      parameters:
        - name: doc_id
          in: path
          required: true
          description: Document ID
          schema:
            type: string
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: List of positions held
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PositionListResponse'

  # ============================================================================
  # Congress.gov API Endpoints
  # ============================================================================

  /v1/congress/bills:
    get:
      tags: [Congress]
      summary: List Congress bills
      description: Get paginated list of bills with optional filtering by congress and bill type
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: congress
          in: query
          description: Filter by congress number (e.g., 118, 119)
          schema:
            type: integer
        - name: bill_type
          in: query
          description: Filter by bill type
          schema:
            type: string
            enum: [hr, s, hres, sres, hjres, sjres, hconres, sconres]
        - name: sponsor
          in: query
          description: Filter by sponsor name (partial match)
          schema:
            type: string
      responses:
        '200':
          description: Paginated list of bills
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BillListResponse'

  /v1/congress/bills/{bill_id}:
    get:
      tags: [Congress]
      summary: Get bill details
      description: Get detailed information about a specific bill
      parameters:
        - name: bill_id
          in: path
          required: true
          description: Bill ID in format congress-type-number (e.g., 118-hr-1)
          schema:
            type: string
          example: "118-hr-1"
      responses:
        '200':
          description: Bill details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BillDetail'
        '404':
          $ref: '#/components/responses/NotFound'

  /v1/congress/members:
    get:
      tags: [Congress]
      summary: List Congress members
      description: Get paginated list of Congress members with optional filtering
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: chamber
          in: query
          description: Filter by chamber
          schema:
            type: string
            enum: [House, Senate]
        - name: state
          in: query
          description: Filter by state
          schema:
            type: string
        - name: party
          in: query
          description: Filter by party
          schema:
            type: string
            enum: [D, R, I]
      responses:
        '200':
          description: Paginated list of Congress members
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CongressMemberListResponse'

  /v1/congress/members/{bioguide_id}:
    get:
      tags: [Congress]
      summary: Get Congress member details
      description: Get detailed profile including legislative stats
      parameters:
        - name: bioguide_id
          in: path
          required: true
          description: Member's bioguide ID
          schema:
            type: string
          example: "P000197"
      responses:
        '200':
          description: Congress member profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CongressMemberDetail'
        '404':
          $ref: '#/components/responses/NotFound'

  /v1/analytics/members/{bioguide_id}/legislation-trades:
    get:
      tags: [Congress, Analytics]
      summary: Get member legislation with trade windows
      description: Get member's sponsored bills with correlated trading activity
      parameters:
        - name: bioguide_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Legislation and trade correlation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LegislationTradesResponse'

  /v1/analytics/stocks/{ticker}/legislative-exposure:
    get:
      tags: [Congress, Analytics]
      summary: Get stock legislative exposure
      description: Get congressional activity and trading for a stock
      parameters:
        - name: ticker
          in: path
          required: true
          schema:
            type: string
          example: "AAPL"
      responses:
        '200':
          description: Stock legislative exposure
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LegislativeExposureResponse'

  # ============================================================================
  # Member Analytics Endpoints
  # ============================================================================

  /v1/members/{name}/filings:
    get:
      tags: [Members]
      summary: Get all filings for a member
      description: |
        Get all financial disclosure filings for a specific congress member.
        Supports case-insensitive partial name matching.
      parameters:
        - name: name
          in: path
          required: true
          description: Member name (case-insensitive, partial match supported)
          schema:
            type: string
          example: pelosi
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: filing_type
          in: query
          description: Filter by filing type
          schema:
            type: string
            enum: [type_p, type_a, type_b, type_c, type_t]
        - name: year
          in: query
          description: Filter by filing year
          schema:
            type: integer
      responses:
        '200':
          description: List of member's filings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FilingListResponse'

  /v1/members/{name}/transactions:
    get:
      tags: [Members]
      summary: Get all transactions for a member
      description: |
        Get all PTR (Periodic Transaction Report) transactions for a specific member.
        Supports case-insensitive partial name matching.
      parameters:
        - name: name
          in: path
          required: true
          description: Member name (case-insensitive, partial match supported)
          schema:
            type: string
          example: pelosi
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: year
          in: query
          description: Filter by transaction year
          schema:
            type: integer
        - name: ticker
          in: query
          description: Filter by stock ticker
          schema:
            type: string
        - name: transaction_type
          in: query
          description: Filter by transaction type
          schema:
            type: string
            enum: [Purchase, Sale, Exchange]
      responses:
        '200':
          description: List of member's transactions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionListResponse'

  /v1/members/{name}/assets:
    get:
      tags: [Members]
      summary: Get member's current portfolio
      description: |
        Get current asset holdings from the member's most recent annual financial disclosure.
        Automatically finds the latest Type A/B/C filing and returns Schedule A assets.
      parameters:
        - name: name
          in: path
          required: true
          description: Member name (case-insensitive, partial match supported)
          schema:
            type: string
          example: pelosi
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: asset_type
          in: query
          description: Filter by asset type
          schema:
            type: string
      responses:
        '200':
          description: Member's current portfolio
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MemberPortfolioResponse'
        '404':
          description: No annual filings found for member

# ============================================================================
# Components
# ============================================================================

components:
  parameters:
    Limit:
      name: limit
      in: query
      description: Number of results per page (max 500)
      schema:
        type: integer
        default: 50
        minimum: 1
        maximum: 500

    Offset:
      name: offset
      in: query
      description: Number of results to skip
      schema:
        type: integer
        default: 0
        minimum: 0

    StartDate:
      name: start_date
      in: query
      description: Start date (YYYY-MM-DD)
      schema:
        type: string
        format: date

    EndDate:
      name: end_date
      in: query
      description: End date (YYYY-MM-DD)
      schema:
        type: string
        format: date

  schemas:
    Member:
      type: object
      properties:
        bioguide_id:
          type: string
        first_name:
          type: string
        last_name:
          type: string
        party:
          type: string
          enum: [D, R, I]
        state:
          type: string
        district:
          type: string

    Trade:
      type: object
      properties:
        transaction_id:
          type: string
        bioguide_id:
          type: string
        ticker:
          type: string
        transaction_type:
          type: string
          enum: [Purchase, Sale, Exchange]
        transaction_date:
          type: string
          format: date
        amount:
          type: number
        filing_date:
          type: string
          format: date

    MemberProfile:
      allOf:
        - $ref: '#/components/schemas/Member'
        - type: object
          properties:
            trading_stats:
              type: object
              properties:
                total_trades:
                  type: integer
                unique_stocks:
                  type: integer
                latest_trade_date:
                  type: string
                  format: date
            recent_filings:
              type: array
              items:
                type: object

    StockSummary:
      type: object
      properties:
        ticker:
          type: string
        statistics:
          type: object
          properties:
            total_trades:
              type: integer
            unique_members:
              type: integer
            purchase_count:
              type: integer
            sale_count:
              type: integer
            latest_trade_date:
              type: string
              format: date
        recent_trades:
          type: array
          items:
            $ref: '#/components/schemas/Trade'

    Pagination:
      type: object
      properties:
        total:
          type: integer
        count:
          type: integer
        limit:
          type: integer
        offset:
          type: integer
        has_next:
          type: boolean
        has_prev:
          type: boolean
        next:
          type: string
          nullable: true
        prev:
          type: string
          nullable: true

    MemberListResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: array
          items:
            $ref: '#/components/schemas/Member'
        pagination:
          $ref: '#/components/schemas/Pagination'

    TradeListResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: array
          items:
            $ref: '#/components/schemas/Trade'
        pagination:
          $ref: '#/components/schemas/Pagination'

    StockListResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: array
          items:
            type: object
        pagination:
          $ref: '#/components/schemas/Pagination'

    PortfolioResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object
          properties:
            bioguide_id:
              type: string
            holdings:
              type: array
              items:
                type: object

    SummaryResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object

    TopTradersResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object
          properties:
            top_traders:
              type: array
              items:
                type: object
            count:
              type: integer

    TrendingStocksResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object

    SectorActivityResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object

    ComplianceResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object

    TimelineResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object

    SearchResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object
          properties:
            query:
              type: string
            results:
              type: object
              properties:
                members:
                  type: array
                  items:
                    $ref: '#/components/schemas/Member'
                stocks:
                  type: array
                  items:
                    type: object

    FilingListResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: array
          items:
            type: object
        pagination:
          $ref: '#/components/schemas/Pagination'

    FilingTransactionListResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: array
          items:
            type: object
            properties:
              doc_id:
                type: string
              transaction_date:
                type: string
                format: date
              ticker:
                type: string
              asset_description:
                type: string
              asset_type:
                type: string
              transaction_type:
                type: string
              amount:
                type: string
              cap_gains_over_200:
                type: boolean
        pagination:
          $ref: '#/components/schemas/Pagination'
        filings:
          type: array
          items:
            $ref: '#/components/schemas/Filing'

    AssetHoldingListResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: array
          items:
            type: object
            properties:
              holding_key:
                type: string
              doc_id:
                type: string
              filing_year:
                type: integer
              filer_name:
                type: string
              state_district:
                type: string
              asset_name:
                type: string
              ticker:
                type: string
              asset_type:
                type: string
              owner:
                type: string
                description: Owner code (Self, SP, DC, JT)
              value_range:
                type: string
                description: Disclosure value category (A-J)
              income_type:
                type: string
              income_amount:
                type: string
        pagination:
          $ref: '#/components/schemas/Pagination'

    PositionListResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: array
          items:
            type: object
            properties:
              position_key:
                type: string
              doc_id:
                type: string
              filing_year:
                type: integer
              filer_name:
                type: string
              state_district:
                type: string
              position_title:
                type: string
        pagination:
          $ref: '#/components/schemas/Pagination'

    TransactionListResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: array
          items:
            type: object
            properties:
              transaction_key:
                type: string
              doc_id:
                type: string
              filing_year:
                type: integer
              filer_name:
                type: string
              state_district:
                type: string
              asset_name:
                type: string
              ticker:
                type: string
              asset_type:
                type: string
              transaction_type:
                type: string
                enum: [Purchase, Sale, Exchange]
              transaction_date:
                type: string
                format: date
              notification_date:
                type: string
                format: date
              amount_range:
                type: string
              amount_low:
                type: integer
              amount_high:
                type: integer
        pagination:
          $ref: '#/components/schemas/Pagination'

    MemberPortfolioResponse:
      type: object
      properties:
        success:
          type: boolean
        member:
          type: string
          description: Member name from filing
        filing_doc_id:
          type: string
          description: Document ID of the latest annual filing
        filing_year:
          type: integer
          description: Year of the latest annual filing
        data:
          type: array
          items:
            type: object
            properties:
              holding_key:
                type: string
              asset_name:
                type: string
              ticker:
                type: string
              asset_type:
                type: string
              owner:
                type: string
              value_range:
                type: string
              income_type:
                type: string
              income_amount:
                type: string
        pagination:
          $ref: '#/components/schemas/Pagination'

    S3Object:
      type: object
      properties:
        name:
          type: string
        type:
          type: string
          enum: [file, folder]
        key:
          type: string
        size:
          type: integer
        lastModified:
          type: string
          format: date-time
        url:
          type: string

    S3ObjectList:
      type: object
      properties:
        layer:
          type: string
        prefix:
          type: string
        bucket:
          type: string
        folders:
          type: array
          items:
            $ref: '#/components/schemas/S3Object'
        files:
          type: array
          items:
            $ref: '#/components/schemas/S3Object'
        truncated:
          type: boolean
        keyCount:
          type: integer
        nextContinuationToken:
          type: string

    CostResponse:
      type: object
      properties:
        start_date:
          type: string
          format: date
        end_date:
          type: string
          format: date
        last_updated:
          type: string
          format: date-time
        total_period_cost:
          type: number
        daily_costs:
          type: array
          items:
            type: object
            properties:
              date:
                type: string
                format: date
              total_cost:
                type: number
              services:
                type: array
                items:
                  type: object
                  properties:
                    service:
                      type: string
                    cost:
                      type: number

    FilingDetail:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object

    # Congress.gov Schemas
    BillListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/Bill'
        pagination:
          $ref: '#/components/schemas/Pagination'

    Bill:
      type: object
      properties:
        bill_id:
          type: string
          example: "118-hr-1"
        congress:
          type: integer
        bill_type:
          type: string
        bill_number:
          type: integer
        title:
          type: string
        sponsor_name:
          type: string
        policy_area:
          type: string
        introduced_date:
          type: string
          format: date

    BillDetail:
      type: object
      properties:
        bill:
          $ref: '#/components/schemas/Bill'

    CongressMemberListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/CongressMember'
        pagination:
          $ref: '#/components/schemas/Pagination'

    CongressMember:
      type: object
      properties:
        bioguide_id:
          type: string
        first_name:
          type: string
        last_name:
          type: string
        party:
          type: string
        state:
          type: string
        chamber:
          type: string
          enum: [house, senate]

    CongressMemberDetail:
      type: object
      properties:
        member:
          allOf:
            - $ref: '#/components/schemas/CongressMember'
            - type: object
              properties:
                bills_sponsored:
                  type: integer
                bills_cosponsored:
                  type: integer
                fd_transaction_count:
                  type: integer

    LegislationTradesResponse:
      type: object
      properties:
        member:
          $ref: '#/components/schemas/CongressMember'
        bills_count:
          type: integer
        bills:
          type: array
          items:
            type: object
            properties:
              bill_id:
                type: string
              role:
                type: string
              trade_windows:
                type: array
                items:
                  type: object
        trades_in_windows:
          type: integer

    LegislativeExposureResponse:
      type: object
      properties:
        ticker:
          type: string
        legislative_activity:
          type: object
          properties:
            exposure_score:
              type: integer
            members_trading:
              type: integer
            total_transactions:
              type: integer
        trading_activity:
          type: object

    Error:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          properties:
            message:
              type: string
            code:
              type: integer
            details:
              type: object

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            success: false
            error:
              message: Invalid request parameters
              code: 400

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            success: false
            error:
              message: Resource not found
              code: 404
